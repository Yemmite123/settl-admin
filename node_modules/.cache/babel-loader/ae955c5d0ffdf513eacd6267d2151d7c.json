{"ast":null,"code":"import _defineProperty from\"/Users/adebayooluyemi/Documents/THE BULB/UPDATED SETTL ADMIN BACKOFFICE /settl-backoffice/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _regeneratorRuntime from\"/Users/adebayooluyemi/Documents/THE BULB/UPDATED SETTL ADMIN BACKOFFICE /settl-backoffice/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/adebayooluyemi/Documents/THE BULB/UPDATED SETTL ADMIN BACKOFFICE /settl-backoffice/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/adebayooluyemi/Documents/THE BULB/UPDATED SETTL ADMIN BACKOFFICE /settl-backoffice/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{connect}from\"react-redux\";import{Link}from\"react-router-dom\";import{Button,Card,Form,FormGroup,Label,Input}from\"reactstrap\";import{Multiselect}from\"multiselect-react-dropdown\";import InputBox from\"./../../components/InputBox\";import{Editor}from\"react-draft-wysiwyg\";import{EditorState,convertToRaw}from'draft-js';import\"react-draft-wysiwyg/dist/react-draft-wysiwyg.css\";import SuccessDialog from\"../SuccessDialog\";import FailureDialog from\"../FailureDialog\";import pdf from\"../../assets/img/icons/pdf.svg\";import messageRequest from\"../../requests/message\";var messageOptions=[{name:\"Email\",id:1},{name:\"SMS\",id:2}];var recipientOptions=[{name:\"All Customers\",id:1},{name:\"All Agents\",id:2},{name:\"Churn Customers\",id:3}// { name: \"Customized Users\" }\n];function CreateNewMessage(_ref){var _React$createElement;var setShowNewMessage=_ref.setShowNewMessage,userName=_ref.userName;var _useState=useState(\"Settl Easter Campaign\"),_useState2=_slicedToArray(_useState,2),title=_useState2[0],setTitle=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),messageType=_useState4[0],setMessageType=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),selectedValues=_useState6[0],setSelectedValues=_useState6[1];var _useState7=useState(EditorState.createEmpty()),_useState8=_slicedToArray(_useState7,2),editorState=_useState8[0],setEditorState=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),showSuccess=_useState10[0],setShowSuccess=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),showFailure=_useState12[0],setShowFailure=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),loading=_useState14[0],setLoading=_useState14[1];var _useState15=useState(\"\"),_useState16=_slicedToArray(_useState15,2),customerTemplate=_useState16[0],setCustomerTemplate=_useState16[1];var _messageRequest=messageRequest(),newMessage=_messageRequest.newMessage;useEffect(function(){window.scrollTo(0,0);},[]);var onEditorStateChange=function onEditorStateChange(editorState){setEditorState(editorState);};var handleSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();setLoading(true);_context.next=4;return newMessage(messageType,userName.split(\" \")[0],title,editorState.getCurrentContent().getPlainText(),selectedValues);case 4:response=_context.sent;if(!(response.code===\"00\")){_context.next=14;break;}console.log(response);setTitle(\"Settl Easter Campaign\");setMessageType(\"\");setSelectedValues(\"\");setEditorState(EditorState.createEmpty());setLoading(false);setShowSuccess(true);return _context.abrupt(\"return\",true);case 14:setLoading(false);setShowFailure(true);return _context.abrupt(\"return\",false);case 17:case\"end\":return _context.stop();}}},_callee);}));return function handleSubmit(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Link,{to:\"/messages\",className:\"back\",onClick:function onClick(){return setShowNewMessage(function(prev){return!prev;});}},\"< Back to All Messages\"),/*#__PURE__*/React.createElement(\"div\",{className:\"w-50 mx-auto\"},/*#__PURE__*/React.createElement(Card,{className:\"p-4\",style:{border:\"1px solid #ECF3FC\"}},/*#__PURE__*/React.createElement(\"h6\",{className:\"text-center\"},\"New Message\"),/*#__PURE__*/React.createElement(Form,{className:\"new-admin-form message-form mt-4\",onSubmit:handleSubmit},/*#__PURE__*/React.createElement(FormGroup,null,/*#__PURE__*/React.createElement(Multiselect,{className:\"forget_pass_select\",options:messageOptions,showCheckbox:false,showArrow:true,displayValue:\"name\",placeholder:messageType===\"\"?\"Message Type\":messageType,singleSelect:true,onSelect:function onSelect(e){return setMessageType(e[0].id);}})),/*#__PURE__*/React.createElement(FormGroup,null,/*#__PURE__*/React.createElement(Multiselect,{className:\"forget_pass_select\",options:recipientOptions,showCheckbox:false,showArrow:true,displayValue:\"name\",placeholder:selectedValues===\"\"?\"Send to\":selectedValues,singleSelect:true,onSelect:function onSelect(e){return setSelectedValues(e[0].id);}})),customerTemplate===\"\"&&selectedValues===\"Customized Users\"&&/*#__PURE__*/React.createElement(FormGroup,{className:\"upload\"},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Label,{htmlFor:\"customerTemplate\"},\"Customer\"),/*#__PURE__*/React.createElement(Input,{type:\"file\",id:\"customerTemplate\",accept:\".png, .jpg, .pdf, .csv\",value:customerTemplate,onChange:function onChange(e){return setCustomerTemplate(e.target.value);}})),/*#__PURE__*/React.createElement(\"span\",{className:\"d-block pt-2\"},\"Max file size should be 20MB.\",/*#__PURE__*/React.createElement(\"a\",{href:\"#\",download:true},\"Download this template format\"))),customerTemplate!==\"\"&&/*#__PURE__*/React.createElement(FormGroup,{className:\"upload\"},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Label,{htmlFor:\"customerTemplate\"},\"Customer\")),/*#__PURE__*/React.createElement(\"div\",{className:\"document-wrapper align-items-center d-flex\"},/*#__PURE__*/React.createElement(\"div\",{className:\"mr-3\"},/*#__PURE__*/React.createElement(\"img\",{src:pdf,alt:\"pdf icon\"})),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"p\",{className:\"mb-0\"},customerTemplate.replace(/^C:\\\\fakepath\\\\/,\"\"))))),/*#__PURE__*/React.createElement(FormGroup,{className:\"pb-3 relative\"},/*#__PURE__*/React.createElement(InputBox,{type:\"text\",name:\"title\",id:\"title\",value:title,onChange:function onChange(e){return setTitle(e.target.value);}}),/*#__PURE__*/React.createElement(Label,{for:\"title\",className:\"label-title\"},\"Title\")),/*#__PURE__*/React.createElement(FormGroup,null,/*#__PURE__*/React.createElement(Editor,(_React$createElement={editorState:editorState,toolbarClassName:\"toolbarClassName\",wrapperClassName:\"wrapperClassName\",editorClassName:\"editorClassName\"},_defineProperty(_React$createElement,\"toolbarClassName\",\"toolbar-class\"),_defineProperty(_React$createElement,\"toolbar\",{options:['inline','link','textAlign','list','image'],inline:{inDropdown:false,options:['bold','italic']},textAlign:{inDropdown:false},link:{inDropdown:false}}),_defineProperty(_React$createElement,\"onEditorStateChange\",onEditorStateChange),_React$createElement)),/*#__PURE__*/React.createElement(\"div\",{className:\"mt-1 text-right\"},/*#__PURE__*/React.createElement(\"p\",{style:{opacity:\"0.7\"}},\"Max 366 Char\"))),/*#__PURE__*/React.createElement(Button,{type:\"submit\",color:\"primary\",className:\"btn-add py-2 w-100\"},\"Send Message\",loading?/*#__PURE__*/React.createElement(\"div\",{className:\"spinner-border spinner-border-sm spinner text-white ml-2\",role:\"status\"},/*#__PURE__*/React.createElement(\"span\",{className:\"sr-only\"},\"Loading...\")):\"\")))),/*#__PURE__*/React.createElement(SuccessDialog,{isOpen:showSuccess,toggle:function toggle(){return setShowSuccess(!showSuccess);},title:\"Success Message\",details:\"Your message has been successfully sent to all Settl customers.\"}),/*#__PURE__*/React.createElement(FailureDialog,{isOpen:showFailure,toggle:function toggle(){return setShowFailure(!showFailure);},title:\"Failure Message\",details:\"Oops! An error occured.\"}));}var mapStateToProps=function mapStateToProps(state){var _state$user,_state$user$details,_state$user$details$a;return{userName:state===null||state===void 0?void 0:(_state$user=state.user)===null||_state$user===void 0?void 0:(_state$user$details=_state$user.details)===null||_state$user$details===void 0?void 0:(_state$user$details$a=_state$user$details.admin)===null||_state$user$details$a===void 0?void 0:_state$user$details$a.fullname};};export default connect(mapStateToProps)(CreateNewMessage);","map":{"version":3,"sources":["/Users/adebayooluyemi/Documents/THE BULB/UPDATED SETTL ADMIN BACKOFFICE /settl-backoffice/src/pages/messaging/CreateNewMessage.js"],"names":["React","useState","useEffect","connect","Link","Button","Card","Form","FormGroup","Label","Input","Multiselect","InputBox","Editor","EditorState","convertToRaw","SuccessDialog","FailureDialog","messageRequest","messageOptions","name","id","recipientOptions","CreateNewMessage","setShowNewMessage","userName","title","setTitle","messageType","setMessageType","selectedValues","setSelectedValues","createEmpty","editorState","setEditorState","showSuccess","setShowSuccess","showFailure","setShowFailure","loading","setLoading","customerTemplate","setCustomerTemplate","newMessage","window","scrollTo","onEditorStateChange","handleSubmit","e","preventDefault","split","getCurrentContent","getPlainText","response","code","console","log","prev","border","target","value","pdf","replace","options","inline","inDropdown","textAlign","link","opacity","mapStateToProps","state","user","details","admin","fullname"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { connect } from \"react-redux\";\nimport { Link } from \"react-router-dom\";\nimport { Button, Card, Form, FormGroup, Label, Input } from \"reactstrap\";\nimport { Multiselect } from \"multiselect-react-dropdown\";\nimport InputBox from \"./../../components/InputBox\";\nimport { Editor } from \"react-draft-wysiwyg\";\nimport { EditorState, convertToRaw } from 'draft-js';\nimport \"react-draft-wysiwyg/dist/react-draft-wysiwyg.css\";\nimport SuccessDialog from \"../SuccessDialog\";\nimport FailureDialog from \"../FailureDialog\";\nimport pdf from \"../../assets/img/icons/pdf.svg\";\nimport messageRequest from \"../../requests/message\";\n\nconst messageOptions = [\n    { name: \"Email\", id: 1 },\n    { name: \"SMS\", id: 2 }\n] \n\nconst recipientOptions = [\n    { name: \"All Customers\", id: 1 },\n    { name: \"All Agents\", id: 2 }, \n    { name: \"Churn Customers\", id: 3 },\n    // { name: \"Customized Users\" }\n]\n\nfunction CreateNewMessage({setShowNewMessage, userName}) {\n    const [title, setTitle] = useState(\"Settl Easter Campaign\");\n    const [messageType, setMessageType] = useState(\"\");\n    const [selectedValues, setSelectedValues] = useState(\"\");\n    const [editorState, setEditorState] = useState(EditorState.createEmpty());\n\n    const [showSuccess, setShowSuccess] = useState(false);\n    const [showFailure, setShowFailure] = useState(false);\n    const [loading, setLoading] = useState(false);\n    \n    const [customerTemplate, setCustomerTemplate] = useState(\"\");\n\n    const { newMessage } = messageRequest();\n\n    useEffect(() => {\n        window.scrollTo(0, 0);\n    }, []);\n\n    const onEditorStateChange = (editorState) => {\n        setEditorState(editorState);\n    };\n\n    const handleSubmit = async (e) => {\n        e.preventDefault();\n        setLoading(true);\n    \n        const response = await newMessage(\n            messageType,\n            userName.split(\" \")[0],\n            title,\n            editorState.getCurrentContent().getPlainText(),\n            selectedValues\n        );\n        if(response.code === \"00\") {\n            console.log(response);\n            setTitle(\"Settl Easter Campaign\");\n            setMessageType(\"\");\n            setSelectedValues(\"\");\n            setEditorState(EditorState.createEmpty());\n            setLoading(false);\n            setShowSuccess(true);\n            return true;\n        } \n\n        setLoading(false);\n        setShowFailure(true);\n        return false;\n    }   \n\n\n    return(\n        <>\n            <Link \n                to=\"/messages\"\n                className=\"back\"\n                onClick={() => setShowNewMessage((prev) => !prev)}\n            >\n                &lt; Back to All Messages\n            </Link>\n            <div className=\"w-50 mx-auto\">\n                <Card className=\"p-4\" style={{border: \"1px solid #ECF3FC\"}}>\n                    <h6 className=\"text-center\">New Message</h6>\n                    <Form \n                        className=\"new-admin-form message-form mt-4\"\n                        onSubmit={handleSubmit}\n                    >\n                        <FormGroup>\n                            <Multiselect\n                                className=\"forget_pass_select\"\n                                options={messageOptions}\n                                showCheckbox={false}\n                                showArrow={true}\n                                displayValue=\"name\"\n                                placeholder={messageType === \"\" ? \"Message Type\" : messageType}\n                                singleSelect={true}\n                                onSelect={(e) => setMessageType(e[0].id)}\n                            />\n                        </FormGroup>\n                        <FormGroup>\n                            <Multiselect\n                                className=\"forget_pass_select\"\n                                options={recipientOptions}\n                                showCheckbox={false}\n                                showArrow={true}\n                                displayValue=\"name\"\n                                placeholder={selectedValues === \"\" ? \"Send to\" : selectedValues}\n                                singleSelect={true}\n                                onSelect={(e) => setSelectedValues(e[0].id)}\n                            />\n                        </FormGroup>\n                        {(customerTemplate === \"\" && selectedValues === \"Customized Users\") && (\n                            <FormGroup className=\"upload\">\n                                <div>\n                                    <Label htmlFor=\"customerTemplate\">Customer</Label>\n                                    <Input \n                                        type=\"file\" \n                                        id=\"customerTemplate\" \n                                        accept=\".png, .jpg, .pdf, .csv\" \n                                        value={customerTemplate}\n                                        onChange={(e) => setCustomerTemplate(e.target.value)}\n                                    />\n                                </div>\n                                <span className=\"d-block pt-2\">\n                                    Max file size should be 20MB. \n                                    <a href=\"#\" download>Download this template format</a>\n                                </span>\n                            </FormGroup>\n                        )}\n                        {customerTemplate !== \"\" && (\n                            <FormGroup className=\"upload\">\n                                <div>\n                                    <Label htmlFor=\"customerTemplate\">Customer</Label>\n                                </div>\n                                <div className=\"document-wrapper align-items-center d-flex\">\n                                    <div className=\"mr-3\">\n                                        <img src={pdf} alt=\"pdf icon\" />\n                                    </div>\n                                    <div>\n                                        <p className=\"mb-0\">\n                                            {customerTemplate.replace(/^C:\\\\fakepath\\\\/, \"\")}\n                                        </p>\n                                    </div>\n                                </div>\n                            </FormGroup>\n                        )}\n                        <FormGroup className=\"pb-3 relative\">\n                            <InputBox\n                                type=\"text\"\n                                name=\"title\"\n                                id=\"title\"\n                                value={title}\n                                onChange={(e) => setTitle(e.target.value)}\n                            />\n                            <Label for=\"title\" className=\"label-title\">Title</Label>\n                        </FormGroup>\n                        <FormGroup>\n                            <Editor\n                                editorState={editorState}\n                                toolbarClassName=\"toolbarClassName\"\n                                wrapperClassName=\"wrapperClassName\"\n                                editorClassName=\"editorClassName\"\n                                toolbarClassName=\"toolbar-class\"\n                                toolbar={{\n                                    options: ['inline', 'link', 'textAlign', 'list', 'image'],\n                                    inline: { \n                                        inDropdown: false,\n                                        options: ['bold', 'italic']\n                                    },\n                                    textAlign: { inDropdown: false },\n                                    link: { inDropdown: false }\n                                }}\n                                onEditorStateChange={onEditorStateChange}\n                            />\n                            <div className=\"mt-1 text-right\">\n                                <p style={{opacity: \"0.7\"}}>Max 366 Char</p>\n                            </div>\n                        </FormGroup>\n                        <Button\n                            type=\"submit\" \n                            color=\"primary\" \n                            className=\"btn-add py-2 w-100\"\n                        >\n                            Send Message\n                            {\n                                loading ? (\n                                <div className=\"spinner-border spinner-border-sm spinner text-white ml-2\" role=\"status\">\n                                    <span className=\"sr-only\">Loading...</span>\n                                </div>) : (\"\")\n                            }\n                        </Button>\n                    </Form>\n                </Card>\n            </div>\n\n            <SuccessDialog \n                isOpen={showSuccess}\n                toggle={() => setShowSuccess(!showSuccess)}\n                title=\"Success Message\"\n                details=\"Your message has been successfully sent to all Settl customers.\"\n            />\n\n            <FailureDialog \n                isOpen={showFailure}\n                toggle={() => setShowFailure(!showFailure)}\n                title=\"Failure Message\"\n                details=\"Oops! An error occured.\"\n            />\n        </>\n    );\n}\n\n\nconst mapStateToProps = (state) => ({\n    userName: state?.user?.details?.admin?.fullname,\n});\nexport default connect(mapStateToProps)(CreateNewMessage);"]},"metadata":{},"sourceType":"module"}